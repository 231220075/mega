# How to Build the Mega

## Build with Cargo

### Build

```bash
cargo build
```

### Test all workspace

```bash
cargo test --workspace
```

### Clippy

```bash
cargo clippy --workspace --all-targets --all-features -- -D warnings
```

### Check

```bash
cargo check
```

### Doc

```bash
cargo doc
```

## Build with Bazel

1. Install [Bazelisk](https://github.com/bazelbuild/bazelisk) on the MacOS:

    ```bash
    brew install bazelisk
    ```

2. Use cargo build to download crates and generate Cargo.lock from the repository:

    ```bash
    cargo build
    ```

3. Now we can run bazel sync to pin cargo dependencies as Bazel targets:

    ```bash
    CARGO_BAZEL_REPIN=1 bazelisk sync --only=crate_index
    ```


    You should run this command **whenever you update dependencies** in Cargo files. We can also use a Bazel query to examine targets generated by crate_universe:

    ```bash
    bazelisk query @crate_index//...
    ```

4. Finally we can build and test the mega:

    ```bash
    bazelisk build //:mega
    ```